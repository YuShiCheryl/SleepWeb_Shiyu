# 🔧 后端集成指南

## ✅ 我刚刚添加了什么

### 1. API 端点（后端功能）

我创建了两个 API 接口：

**📧 邮件订阅 API** (`app/api/subscribe/route.ts`)
- 接收用户邮箱
- 验证邮箱格式
- 可以连接到邮件服务

**📝 联系表单 API** (`app/api/contact/route.ts`)
- 接收用户留言
- 验证必填字段
- 可以发送邮件通知

### 2. 前端集成

更新了 `Footer.tsx`，现在订阅功能是真实可用的！
- 输入邮箱点击订阅
- 显示成功/失败消息
- 有加载状态

---

## 🎯 现在的架构

```
前端（浏览器）
    ↓
Next.js (前端 + 后端)
    ↓
API Routes（你的后端代码）
    ↓
外部服务（邮件、数据库等）
```

**优势**：
- ✅ 一个项目包含前端和后端
- ✅ 用同样的语言（TypeScript）
- ✅ 部署简单（一起部署）

---

## 🚀 常用后端集成方案

### 方案 1：邮件服务（最常用）

**Resend（推荐，国内可用）**
```bash
npm install resend
```

```typescript
// app/api/subscribe/route.ts
import { Resend } from 'resend'

const resend = new Resend(process.env.RESEND_API_KEY)

export async function POST(request: Request) {
  const { email } = await request.json()
  
  // 发送欢迎邮件
  await resend.emails.send({
    from: 'noreply@yourdomain.com',
    to: email,
    subject: '欢迎订阅！',
    html: '<h1>感谢订阅我们的产品资讯</h1>'
  })
  
  return NextResponse.json({ success: true })
}
```

**其他选择**：
- SendGrid（免费额度：100封/天）
- Mailgun
- 阿里云邮件推送

### 方案 2：数据库存储

**Vercel Postgres（最简单）**
```bash
npm install @vercel/postgres
```

```typescript
import { sql } from '@vercel/postgres'

export async function POST(request: Request) {
  const { email } = await request.json()
  
  // 存储到数据库
  await sql`
    INSERT INTO subscribers (email, created_at)
    VALUES (${email}, NOW())
  `
  
  return NextResponse.json({ success: true })
}
```

**其他选择**：
- MongoDB Atlas（免费 512MB）
- Supabase（免费开源的 Firebase 替代品）
- PlanetScale（MySQL）

### 方案 3：第三方表单服务（最简单，无需代码）

**Formspree**
- 访问 https://formspree.io/
- 注册并创建表单
- 得到一个 URL，直接在前端调用

```typescript
// 不需要写后端代码！
const response = await fetch('https://formspree.io/f/YOUR_FORM_ID', {
  method: 'POST',
  body: JSON.stringify({ email }),
  headers: { 'Content-Type': 'application/json' }
})
```

**其他选择**：
- Tally（国内可用）
- Typeform
- Google Forms

### 方案 4：即时通讯集成

**企业微信/钉钉机器人**
```typescript
export async function POST(request: Request) {
  const { name, email, message } = await request.json()
  
  // 发送到企业微信群
  await fetch(process.env.WECHAT_WEBHOOK_URL, {
    method: 'POST',
    body: JSON.stringify({
      msgtype: 'text',
      text: {
        content: `新留言：\n姓名：${name}\n邮箱：${email}\n内容：${message}`
      }
    })
  })
  
  return NextResponse.json({ success: true })
}
```

### 方案 5：支付集成（电商需要）

**Stripe（国际支付）**
```bash
npm install stripe
```

**支付宝/微信支付**
- 需要企业认证
- 集成 SDK

---

## 📊 我的建议

### 如果只是展示网站：
❌ **暂时不需要后端**
- 现在的静态网站就够了
- 节省成本和开发时间

### 如果需要收集用户信息：
✅ **使用 Formspree 或 Tally**
- 最简单，不用写代码
- 免费额度够用
- 数据会发到你邮箱

### 如果需要完整的用户系统：
✅ **使用 Supabase**
- 免费的用户认证
- 数据库
- 实时功能
- 有中文文档

### 如果需要在线商城：
✅ **使用 Shopify 或 Stripe**
- Shopify：完整的电商平台（付费）
- Stripe：支付集成（按交易收费）

---

## 🎯 快速测试订阅功能

1. 确保开发服务器在运行（`npm run dev`）
2. 打开 http://localhost:3000
3. 滚动到页脚
4. 输入邮箱点击订阅
5. 看到"✅ 订阅成功"
6. 在终端会看到日志：`新订阅邮箱: xxx@xxx.com`

现在这只是保存到控制台日志，但你可以轻松改成：
- 发送邮件
- 存储到数据库
- 发送到企业微信

---

## 💡 总结

| 需求 | 方案 | 难度 | 成本 |
|------|------|------|------|
| 展示网站 | 纯前端 | ⭐ | 免费 |
| 表单收集 | Formspree | ⭐ | 免费/付费 |
| 用户系统 | Supabase | ⭐⭐ | 免费额度 |
| 发送邮件 | Resend | ⭐⭐ | 免费额度 |
| 在线支付 | Stripe | ⭐⭐⭐ | 按交易收费 |
| 完整电商 | Shopify | ⭐⭐⭐⭐ | 月费 |

---

需要我帮你集成任何具体的后端功能吗？告诉我你的需求，我可以帮你实现！

